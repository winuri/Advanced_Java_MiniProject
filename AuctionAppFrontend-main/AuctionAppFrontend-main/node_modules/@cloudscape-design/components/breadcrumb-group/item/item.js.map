{"version":3,"file":"item.js","sourceRoot":"","sources":["../../../../src/breadcrumb-group/item/item.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport { BreadcrumbGroupProps, BreadcrumbItemProps } from '../interfaces';\nimport InternalIcon from '../../icon/internal';\nimport styles from './styles.css.js';\nimport clsx from 'clsx';\nimport useFocusVisible from '../../internal/hooks/focus-visible';\nimport { fireCancelableEvent, isPlainLeftClick } from '../../internal/events';\nimport { getEventDetail } from '../internal';\nimport { Transition } from '../../internal/components/transition';\nimport PopoverContainer from '../../popover/container';\nimport PopoverBody from '../../popover/body';\nimport Portal from '../../internal/components/portal';\nimport popoverStyles from '../../popover/styles.css.js';\n\ntype BreadcrumbItemWithPopoverProps<T extends BreadcrumbGroupProps.Item> =\n  React.AnchorHTMLAttributes<HTMLAnchorElement> & {\n    item: T;\n  };\n\nconst BreadcrumbItemWithPopover = <T extends BreadcrumbGroupProps.Item>({\n  item,\n  ...anchorAttributes\n}: BreadcrumbItemWithPopoverProps<T>) => {\n  const focusVisible = useFocusVisible();\n  const [showPopover, setShowPopover] = useState(false);\n  const textRef = useRef<HTMLElement>(null);\n  const virtualTextRef = useRef<HTMLElement>(null);\n\n  const isTruncated = (textRef: React.RefObject<HTMLElement>, virtualTextRef: React.RefObject<HTMLElement>) => {\n    if (!textRef || !virtualTextRef || !textRef.current || !virtualTextRef.current) {\n      return false;\n    }\n    const virtualTextWidth = virtualTextRef.current.getBoundingClientRect().width;\n    const textWidth = textRef.current.getBoundingClientRect().width;\n    if (virtualTextWidth > textWidth) {\n      return true;\n    }\n    return false;\n  };\n\n  const popoverContent = (\n    <Portal>\n      <div className={styles['item-popover']}>\n        <Transition in={true}>\n          {() => (\n            <PopoverContainer\n              trackRef={textRef}\n              size=\"small\"\n              fixedWidth={false}\n              position=\"bottom\"\n              arrow={position => (\n                <div className={clsx(popoverStyles.arrow, popoverStyles[`arrow-position-${position}`])}>\n                  <div className={popoverStyles['arrow-outer']} />\n                  <div className={popoverStyles['arrow-inner']} />\n                </div>\n              )}\n            >\n              <PopoverBody dismissButton={false} dismissAriaLabel={undefined} onDismiss={() => {}} header={undefined}>\n                {item.text}\n              </PopoverBody>\n            </PopoverContainer>\n          )}\n        </Transition>\n      </div>\n    </Portal>\n  );\n\n  useEffect(() => {\n    const onKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setShowPopover(false);\n      }\n    };\n    if (showPopover) {\n      document.addEventListener('keydown', onKeyDown);\n    }\n    return () => {\n      document.removeEventListener('keydown', onKeyDown);\n    };\n  }, [showPopover]);\n\n  return (\n    <>\n      <a\n        {...focusVisible}\n        {...anchorAttributes}\n        onFocus={() => {\n          isTruncated(textRef, virtualTextRef) && setShowPopover(true);\n        }}\n        onBlur={() => setShowPopover(false)}\n        onMouseEnter={() => {\n          isTruncated(textRef, virtualTextRef) && setShowPopover(true);\n        }}\n        onMouseLeave={() => setShowPopover(false)}\n      >\n        <span className={styles.text} ref={textRef}>\n          {item.text}\n        </span>\n        <span className={styles['virtual-item']} ref={virtualTextRef}>\n          {item.text}\n        </span>\n      </a>\n      {showPopover && popoverContent}\n    </>\n  );\n};\n\nexport function BreadcrumbItem<T extends BreadcrumbGroupProps.Item>({\n  item,\n  onClick,\n  onFollow,\n  isDisplayed,\n  isLast = false,\n  isCompressed = false,\n}: BreadcrumbItemProps<T>) {\n  const focusVisible = useFocusVisible();\n  const preventDefault = (event: React.MouseEvent) => event.preventDefault();\n  const onClickHandler = (event: React.MouseEvent) => {\n    if (isPlainLeftClick(event)) {\n      fireCancelableEvent(onFollow, getEventDetail(item), event);\n    }\n    fireCancelableEvent(onClick, getEventDetail(item), event);\n  };\n\n  const anchorAttributes: React.AnchorHTMLAttributes<HTMLAnchorElement> = {\n    href: isLast ? undefined : item.href || '#',\n    className: clsx(styles.anchor, { [styles.compressed]: isCompressed }),\n    'aria-current': isLast ? 'page' : undefined, // Active breadcrumb item is implemented according to WAI-ARIA 1.1\n    'aria-disabled': isLast && 'true',\n    onClick: isLast ? preventDefault : onClickHandler,\n    tabIndex: isLast ? 0 : undefined, // tabIndex is added to the last crumb to keep it in the index without an href\n  };\n\n  return (\n    <>\n      <div className={clsx(styles.breadcrumb, isLast && styles.last)}>\n        {isDisplayed && isCompressed ? (\n          <BreadcrumbItemWithPopover item={item} {...anchorAttributes} />\n        ) : (\n          <a {...focusVisible} {...anchorAttributes}>\n            <span className={styles.text}>{item.text}</span>\n          </a>\n        )}\n        {!isLast ? (\n          <span className={styles.icon}>\n            <InternalIcon name=\"angle-right\" />\n          </span>\n        ) : null}\n      </div>\n    </>\n  );\n}\n"]}